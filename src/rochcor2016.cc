#define rochcor2016_cxx
#include "../interface/rochcor2016.h"
#include "TLorentzVector.h"

#include "../interface/RoccoR.h"



const double rochcor2016::netabin[25] = {-2.4,-2.25,-2.1,-1.85,-1.6,-1.4,-1.2,-1.0,-0.8,-0.6,-0.4,-0.2,
					 0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.85,2.1,2.25,2.4};

const double rochcor2016::anetabin[13] = {0.0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.85,2.1,2.25,2.4};


//---------------------------------------------------------------------------------------------  
const double rochcor2016::dcor_bf[16][24]={{-0.000037929,-0.000058448,-0.000019766,-0.000025015,-0.000017566,-0.000026885,-0.000014386,0.000049673,0.000051196,0.000029960,0.000088502,0.000063196,0.000033865,0.000064693,0.000059667,0.000024253,0.000057061,0.000000849,0.000004751,0.000011089,-0.000020144,-0.000053400,-0.000041872,-0.000012298},
{-0.000126151,-0.000121382,-0.000037112,-0.000071194,-0.000011865,-0.000013388,0.000007838,0.000010699,0.000064006,0.000008261,0.000021114,0.000091409,0.000081591,0.000015096,0.000042620,0.000025586,0.000020687,0.000004661,-0.000016761,-0.000043375,-0.000036958,-0.000059630,-0.000080010,-0.000000157},
{-0.000114302,0.000004834,-0.000036528,-0.000042224,-0.000022031,-0.000050880,0.000047405,0.000031130,0.000004028,0.000069156,0.000046463,0.000066672,0.000040434,0.000046349,0.000063299,0.000073427,0.000021751,0.000015892,0.000006075,0.000003292,0.000012558,0.000010741,-0.000065049,-0.000052520},
{0.000039457,-0.000030159,-0.000024814,-0.000028861,-0.000024995,-0.000004832,0.000019838,0.000022994,0.000019691,0.000039102,0.000042217,0.000065573,0.000076515,0.000069172,0.000033961,0.000008922,-0.000006201,0.000040731,-0.000006087,0.000026096,-0.000012833,0.000002775,-0.000024217,-0.000087246},
{-0.000072525,0.000053141,-0.000029405,0.000010867,-0.000002555,0.000045091,-0.000019166,0.000021685,0.000021589,0.000042185,0.000026089,0.000033240,0.000036408,0.000034736,0.000069678,0.000030014,0.000049147,0.000031537,0.000001544,0.000039252,0.000014329,0.000016811,-0.000011692,-0.000025250},
{-0.000022671,-0.000056727,-0.000042781,-0.000037571,-0.000017217,0.000004578,0.000022088,0.000018185,-0.000008166,0.000029144,0.000045373,0.000027385,0.000049178,0.000076961,0.000028559,0.000051532,0.000060345,0.000033693,0.000019119,-0.000043997,-0.000029258,-0.000017043,-0.000004363,-0.000026221},
{-0.000076995,-0.000112091,-0.000023792,-0.000049974,-0.000022852,-0.000023093,-0.000032651,0.000025050,0.000050293,0.000018134,0.000051015,0.000016784,0.000047545,0.000003919,0.000052001,0.000034602,0.000004331,0.000022053,0.000017972,-0.000018769,-0.000004108,-0.000041871,-0.000069902,-0.000020458},
{-0.000097512,-0.000087359,-0.000019933,-0.000023250,0.000018946,-0.000023970,0.000003180,0.000048286,0.000033973,-0.000028446,0.000003853,0.000047925,0.000046302,0.000091543,0.000001267,0.000037865,0.000010474,0.000016813,0.000005857,0.000000027,-0.000006584,-0.000076935,0.000021579,-0.000067142},
{-0.000001995,0.000026287,-0.000022879,-0.000029741,-0.000040747,-0.000010392,0.000023515,0.000046830,0.000007523,0.000046472,0.000035680,0.000032095,0.000043013,0.000041000,0.000036762,0.000027479,0.000009265,-0.000004161,-0.000001544,0.000048362,0.000002269,-0.000050175,-0.000123457,-0.000164823},
{-0.000088341,-0.000010027,-0.000013566,-0.000005830,0.000002544,0.000061553,0.000051782,0.000030833,0.000031539,0.000026240,0.000069934,0.000078125,0.000010347,0.000021812,0.000054151,0.000017861,0.000029381,0.000063523,0.000016174,0.000028856,-0.000036489,-0.000021963,0.000020098,-0.000114630},
{-0.000139660,-0.000070527,-0.000042727,0.000013503,-0.000011730,-0.000049576,-0.000017282,0.000029526,0.000008946,0.000024126,0.000079253,0.000017614,0.000044208,0.000040169,0.000032223,0.000045008,0.000066933,0.000019175,-0.000053414,-0.000012487,-0.000037016,-0.000073915,-0.000061185,-0.000100375},
{-0.000069615,-0.000029569,-0.000045922,-0.000071958,-0.000044835,-0.000031142,-0.000028602,0.000000713,0.000003782,0.000053942,0.000077402,0.000047422,0.000038013,0.000051062,0.000053756,0.000018456,0.000027789,0.000034497,0.000022539,-0.000035792,-0.000019750,-0.000004283,-0.000071859,-0.000005079},
{-0.000073838,-0.000024445,-0.000064251,-0.000059583,-0.000034597,-0.000000254,0.000026621,0.000025412,-0.000017754,0.000029721,0.000024060,0.000033035,0.000015585,0.000017412,0.000056033,0.000017234,0.000017189,0.000006046,0.000012866,-0.000028156,-0.000014556,-0.000084220,-0.000095491,0.000037085},
{-0.000085892,-0.000054063,-0.000066936,-0.000028212,-0.000013898,-0.000013820,0.000031758,0.000003497,0.000029223,0.000006054,0.000012397,0.000059896,0.000034552,0.000030492,0.000026331,0.000082178,0.000034147,0.000042812,-0.000000065,-0.000041167,-0.000011411,-0.000051070,0.000041423,-0.000135471},
{-0.000024031,-0.000124441,0.000072890,-0.000024457,0.000004729,0.000012394,0.000011143,0.000048328,0.000042575,0.000053236,0.000070622,0.000078736,0.000067438,0.000017803,0.000017552,0.000047497,0.000049098,0.000043029,-0.000000567,0.000012723,0.000013498,-0.000021903,-0.000027142,-0.000137852},
{-0.000125014,-0.000069774,0.000002939,-0.000015774,-0.000028441,0.000004966,0.000055652,-0.000010632,0.000087461,0.000027820,0.000043538,0.000045468,0.000056070,0.000048078,0.000045068,0.000018672,0.000005435,0.000047476,0.000002370,0.000002872,-0.000030349,-0.000001986,0.000036776,-0.000040429}};
const double rochcor2016::dcor_ma[16][24]={{0.000515493,0.000489243,0.000314971,0.000123588,0.000024407,-0.000035687,-0.000051707,-0.000012494,-0.000097187,-0.000068015,-0.000056452,-0.000079336,-0.000105766,-0.000062527,-0.000067493,-0.000072548,-0.000102880,-0.000086289,-0.000111897,-0.000098766,-0.000044678,-0.000003330,-0.000112226,-0.000073265},
{0.000686886,0.000425362,0.000242713,0.000126936,0.000061725,0.000027514,-0.000057391,-0.000003830,-0.000016086,-0.000034342,-0.000054552,0.000011093,-0.000060529,-0.000032160,-0.000039932,-0.000042407,-0.000040590,0.000014980,-0.000013361,-0.000001190,0.000071035,0.000118706,0.000115416,0.000137902},
{0.000622411,0.000402270,0.000219932,0.000075912,0.000014603,-0.000016760,-0.000046949,0.000008912,0.000005331,-0.000033384,-0.000033634,-0.000050098,-0.000012861,-0.000010763,0.000004389,0.000018001,0.000011889,-0.000030264,0.000022782,0.000069706,0.000122159,0.000192803,0.000184642,0.000139752},
{0.000390291,0.000245102,0.000118158,0.000059550,0.000041388,-0.000000774,0.000029381,-0.000026741,0.000078686,0.000008140,0.000010417,0.000020146,0.000060076,0.000010704,0.000032829,0.000018297,0.000077704,0.000042497,0.000036154,0.000075628,0.000128820,0.000218347,0.000121675,0.000069247},
{0.000096426,-0.000049383,-0.000026691,-0.000036214,-0.000010922,-0.000026463,0.000027053,0.000074750,0.000038571,0.000035835,0.000006437,0.000042647,0.000023015,0.000031562,-0.000011318,-0.000012695,0.000042956,0.000031429,-0.000056593,0.000025334,0.000104679,0.000118439,0.000081284,0.000180623},
{-0.000285283,-0.000221672,-0.000140621,-0.000088817,0.000017791,0.000060518,0.000050425,0.000040775,0.000065858,0.000018300,0.000041910,0.000060316,0.000025559,0.000049282,0.000052811,0.000031153,0.000007028,-0.000000009,-0.000013653,0.000006828,0.000040544,0.000113546,0.000122228,0.000197397},
{-0.000474313,-0.000267717,-0.000229400,-0.000079367,-0.000000614,-0.000006225,0.000059792,0.000062967,0.000073750,0.000054411,0.000032114,0.000055035,0.000020025,0.000016741,0.000086022,0.000049500,0.000037127,0.000045409,0.000057633,-0.000020453,-0.000000310,0.000086914,0.000192010,0.000390546},
{-0.000570150,-0.000372945,-0.000264393,-0.000096955,-0.000067860,0.000044953,0.000044461,0.000047804,0.000061151,0.000056254,0.000028266,0.000070833,0.000050762,0.000048905,0.000085443,0.000101383,0.000072569,0.000097537,0.000039079,0.000041885,0.000001458,0.000020673,0.000199424,0.000237474},
{-0.000679455,-0.000420171,-0.000222924,-0.000140151,-0.000023715,0.000044600,0.000075349,0.000074444,0.000054706,0.000080868,0.000091321,0.000039008,0.000043746,0.000033141,0.000015631,0.000064008,0.000037384,0.000046402,0.000025301,0.000049532,0.000040114,0.000004498,0.000186791,0.000536530},
{-0.000527655,-0.000419051,-0.000193319,-0.000125290,0.000017688,0.000025991,0.000053697,0.000063631,0.000045208,0.000039770,0.000051291,0.000050865,0.000034769,0.000027729,0.000051299,0.000068782,0.000068506,0.000057465,0.000086461,0.000070112,0.000055209,0.000052044,0.000144496,0.000428727},
{-0.000468161,-0.000357336,-0.000155792,-0.000042193,-0.000062399,0.000016508,0.000016033,-0.000001249,-0.000019150,0.000000889,0.000044090,-0.000009180,0.000013285,0.000013318,0.000003763,0.000016166,0.000020907,-0.000003658,0.000022487,0.000017872,-0.000016906,-0.000002660,-0.000003265,0.000245414},
{-0.000344528,-0.000211232,-0.000105190,0.000004350,-0.000083714,-0.000007667,0.000007438,0.000000141,-0.000000917,-0.000015322,-0.000039538,-0.000050186,-0.000027713,-0.000036249,-0.000030318,-0.000037840,-0.000065200,-0.000019231,-0.000005405,-0.000078999,-0.000014222,-0.000147389,-0.000147396,0.000090095},
{0.000008816,0.000058060,0.000044486,-0.000008247,-0.000062112,0.000030116,0.000032045,0.000035124,-0.000021112,-0.000045480,-0.000051963,-0.000033072,-0.000059813,-0.000060882,-0.000065129,-0.000045361,-0.000066134,-0.000035802,-0.000097608,-0.000080208,-0.000081810,-0.000238295,-0.000143532,0.000015573},
{0.000000998,0.000120708,0.000055432,0.000019775,-0.000015871,0.000008558,-0.000021592,-0.000022905,-0.000033295,-0.000036767,-0.000071281,-0.000049609,-0.000111412,-0.000091904,-0.000101579,-0.000100335,-0.000097529,-0.000123275,-0.000151555,-0.000105482,-0.000130602,-0.000218955,-0.000286549,-0.000206003},
{0.000221335,0.000355104,0.000151775,0.000035817,-0.000015296,-0.000007344,-0.000013185,-0.000060477,-0.000042567,-0.000034815,-0.000043764,-0.000070289,-0.000076901,-0.000083049,-0.000098081,-0.000118569,-0.000134801,-0.000136327,-0.000170280,-0.000200915,-0.000141881,-0.000250131,-0.000243840,-0.000216926},
{0.000380646,0.000388477,0.000263473,0.000108248,0.000013681,-0.000029680,-0.000025295,-0.000018954,-0.000068486,-0.000070016,-0.000051252,-0.000087927,-0.000106110,-0.000104070,-0.000082304,-0.000100167,-0.000103540,-0.000169092,-0.000199160,-0.000144927,-0.000139859,-0.000156033,-0.000170243,-0.000293293}};
const double rochcor2016::mcor_bf[16][24]={{-0.000083438,-0.000024775,0.000010718,-0.000022539,0.000009794,-0.000001975,0.000013988,0.000032673,0.000033087,0.000026351,0.000028646,0.000023370,0.000031574,0.000027364,0.000029944,0.000023743,0.000022900,0.000031065,0.000007027,0.000019530,-0.000012620,-0.000009563,-0.000047023,-0.000114802},
{-0.000074332,-0.000050006,0.000001815,-0.000017369,0.000005789,-0.000006807,0.000036750,0.000018487,0.000027587,0.000028465,0.000027463,0.000050747,0.000038193,0.000020820,0.000036948,0.000041371,0.000028863,0.000016243,0.000008955,-0.000007066,-0.000014613,-0.000025547,-0.000036338,-0.000039613},
{-0.000031832,-0.000072046,-0.000040971,-0.000013504,-0.000012123,-0.000001084,0.000020927,0.000008754,0.000016747,0.000032913,0.000021762,0.000038020,0.000046160,0.000051659,0.000024711,0.000013212,0.000027497,0.000023299,0.000006606,-0.000001346,-0.000001317,0.000005165,-0.000008840,-0.000075224},
{-0.000121454,-0.000080975,-0.000036492,-0.000021653,0.000003671,0.000002616,0.000015535,0.000024712,0.000025969,0.000036287,0.000014835,0.000047708,0.000036755,0.000029053,0.000023315,0.000023813,0.000020648,0.000026010,-0.000010316,0.000011604,-0.000013478,-0.000016756,0.000023180,-0.000067463},
{-0.000126123,-0.000005744,0.000005063,-0.000009777,0.000009522,0.000016494,0.000011777,0.000022615,0.000040029,0.000018798,0.000019238,0.000028727,0.000038084,0.000022586,0.000049002,0.000027651,0.000044090,0.000001088,0.000003603,-0.000005411,-0.000014920,-0.000022195,-0.000022484,-0.000079533},
{-0.000043015,-0.000029120,-0.000031240,-0.000026236,-0.000012172,0.000024225,0.000039653,0.000019034,0.000035229,0.000033683,0.000040231,0.000029384,0.000041336,0.000053059,0.000022215,0.000017799,0.000015112,0.000016430,0.000016700,-0.000005673,-0.000017339,-0.000012662,-0.000017557,-0.000007545},
{-0.000099311,-0.000061419,-0.000005431,-0.000016393,-0.000013526,0.000005503,0.000037652,0.000025645,0.000034611,0.000031754,0.000026522,0.000028925,0.000042142,0.000023402,0.000031236,0.000031505,0.000021724,0.000027578,0.000008979,-0.000008524,0.000004177,-0.000029243,-0.000055444,-0.000051480},
{-0.000083421,-0.000072276,0.000011331,-0.000020114,0.000015735,0.000018251,0.000016402,0.000025082,0.000027127,0.000034016,0.000039534,0.000052235,0.000036037,0.000049893,0.000028738,0.000040385,0.000044710,0.000018495,0.000008885,0.000008633,0.000008153,-0.000025658,0.000014062,-0.000037009},
{-0.000038161,-0.000010341,-0.000000565,0.000000861,0.000000105,0.000008926,0.000046217,0.000038861,0.000043188,0.000018493,0.000037340,0.000042854,0.000045992,0.000032877,0.000045007,0.000032483,0.000025239,0.000012609,0.000027704,0.000011616,0.000009947,-0.000022089,-0.000060479,-0.000017607},
{-0.000083898,-0.000008890,0.000000012,-0.000002915,0.000013170,0.000053390,0.000056076,0.000026699,0.000039490,0.000035348,0.000046422,0.000041642,0.000045803,0.000057236,0.000038231,0.000039290,0.000018296,0.000045930,0.000024041,0.000012266,-0.000017879,-0.000022002,-0.000017780,-0.000101088},
{-0.000067147,-0.000043732,0.000001815,-0.000013060,0.000019881,0.000002645,0.000001774,0.000034722,0.000031985,0.000046538,0.000053361,0.000031857,0.000043769,0.000043786,0.000039503,0.000039760,0.000026524,0.000035808,-0.000008867,-0.000016646,-0.000014705,-0.000031307,-0.000024985,-0.000050282},
{-0.000059436,0.000027395,-0.000009129,0.000010769,-0.000007180,0.000022353,0.000024673,0.000022591,0.000031691,0.000046652,0.000049437,0.000057959,0.000049013,0.000031934,0.000054927,0.000018778,0.000008213,0.000031325,0.000031822,-0.000004086,-0.000002940,-0.000000154,-0.000046634,-0.000020271},
{-0.000028677,-0.000069334,-0.000037798,-0.000014078,-0.000003171,0.000016321,0.000020874,0.000025219,0.000028897,0.000032616,0.000043518,0.000040275,0.000038265,0.000025021,0.000049245,0.000029739,0.000041211,0.000028282,-0.000001769,0.000003185,-0.000017897,-0.000007514,-0.000021362,-0.000066066},
{-0.000024853,-0.000024386,-0.000010110,-0.000017571,0.000012459,0.000000607,0.000033030,0.000039114,0.000037001,0.000025155,0.000024029,0.000033817,0.000052310,0.000051695,0.000033989,0.000038749,0.000034300,0.000020735,0.000007628,0.000003898,-0.000007191,-0.000001402,-0.000045240,-0.000060620},
{-0.000046516,-0.000031928,-0.000024861,0.000008413,0.000016133,-0.000009150,0.000032828,0.000018925,0.000033680,0.000039338,0.000043815,0.000042061,0.000047421,0.000045832,0.000030200,0.000016176,0.000041541,0.000028627,0.000018136,0.000001300,-0.000002147,-0.000044010,-0.000042029,-0.000059565},
{-0.000033149,-0.000068953,-0.000016970,0.000000761,-0.000013459,-0.000002180,0.000037573,0.000038950,0.000042789,0.000035772,0.000033079,0.000031322,0.000031236,0.000023221,0.000027091,0.000025229,0.000013004,0.000034236,0.000019841,0.000009307,-0.000006286,-0.000026545,-0.000043826,-0.000067632}};
const double rochcor2016::mcor_ma[16][24]={{-0.000025584,-0.000028739,-0.000009977,-0.000010214,0.000028809,0.000000678,-0.000015433,-0.000030375,-0.000041852,-0.000045634,-0.000030041,-0.000042279,-0.000041140,-0.000023497,-0.000040591,-0.000020706,-0.000021013,-0.000021608,-0.000024275,-0.000027932,-0.000028308,-0.000020159,-0.000100256,-0.000098397},
{-0.000042414,-0.000017653,-0.000038105,-0.000030669,0.000000768,-0.000013000,-0.000042193,-0.000048263,-0.000032537,-0.000034454,-0.000050218,-0.000023253,-0.000032962,-0.000033627,-0.000032533,-0.000027317,-0.000031886,-0.000020239,-0.000024166,0.000004706,-0.000005603,0.000013615,0.000049321,0.000073569},
{0.000043616,-0.000014168,-0.000010173,-0.000013857,-0.000034369,-0.000045458,-0.000058157,-0.000043996,-0.000027196,-0.000029978,-0.000031937,-0.000028736,-0.000021955,-0.000010666,-0.000030856,-0.000026800,-0.000024745,-0.000028228,0.000015676,0.000019124,0.000013314,0.000018832,0.000071763,0.000136422},
{-0.000065499,-0.000033454,-0.000073438,-0.000039351,-0.000035185,-0.000017767,-0.000037890,-0.000057620,-0.000017726,-0.000032430,-0.000015186,-0.000003061,-0.000012519,-0.000022136,-0.000013692,-0.000020780,-0.000003344,-0.000007190,0.000030869,0.000026891,0.000042694,0.000033225,0.000036990,0.000060220},
{-0.000028060,-0.000083735,-0.000030776,-0.000030475,0.000001373,-0.000006753,-0.000017949,-0.000002885,-0.000020828,-0.000022874,-0.000013734,-0.000018526,-0.000016971,-0.000002853,-0.000017714,-0.000002401,0.000001203,0.000002531,0.000018640,0.000030889,0.000045482,0.000009696,0.000036633,0.000022588},
{0.000021022,-0.000024379,-0.000005924,-0.000010527,0.000014065,0.000006305,0.000002599,0.000004992,0.000001813,-0.000009211,0.000000442,-0.000002523,0.000000860,0.000008914,-0.000000463,0.000009467,-0.000015376,0.000011425,-0.000001837,-0.000007539,0.000005285,0.000000386,-0.000033311,-0.000017380},
{0.000134820,0.000044266,0.000046658,-0.000002304,0.000022482,0.000008917,-0.000006289,0.000012277,0.000012733,0.000005863,0.000012224,-0.000000109,-0.000002199,0.000009682,0.000021819,0.000017294,0.000011952,0.000021987,-0.000007422,-0.000001222,-0.000026153,-0.000020078,-0.000002504,0.000034371},
{0.000122690,0.000078140,0.000049170,0.000041144,0.000018259,0.000011732,-0.000009172,0.000007935,0.000010232,0.000014076,-0.000000839,0.000004631,0.000010660,-0.000002255,0.000020054,0.000016620,0.000014238,0.000018319,-0.000009764,0.000020198,-0.000016607,-0.000024336,-0.000013888,-0.000015683},
{0.000069126,0.000025997,0.000060172,0.000025123,0.000025121,-0.000001984,0.000011035,0.000000786,0.000016875,0.000017335,0.000020136,-0.000006808,-0.000002194,-0.000005213,-0.000009280,0.000013534,0.000001431,0.000002666,0.000011374,0.000019652,0.000005055,0.000022671,0.000007238,0.000089179},
{-0.000035251,-0.000012668,0.000007930,0.000002741,-0.000015603,-0.000011784,-0.000023006,-0.000019753,0.000018226,0.000006397,0.000007933,-0.000003276,0.000003428,-0.000007602,0.000003757,0.000002786,0.000018167,0.000021064,0.000028512,0.000024188,0.000052321,0.000077821,0.000090793,0.000122868},
{-0.000078614,-0.000071147,-0.000045538,-0.000032017,-0.000036521,-0.000026398,-0.000027509,-0.000015324,-0.000020363,-0.000026726,-0.000008374,-0.000001718,0.000009731,0.000004884,0.000005824,0.000002402,0.000003001,0.000002814,-0.000007699,0.000026750,0.000037065,0.000067696,0.000061257,0.000084514},
{-0.000093426,-0.000055184,-0.000037224,-0.000011877,-0.000044286,-0.000037559,-0.000029689,-0.000023379,-0.000021128,-0.000017399,-0.000031182,-0.000014105,-0.000001844,0.000018553,-0.000011064,0.000004174,0.000003786,0.000012118,0.000018481,0.000003794,0.000022340,0.000018930,0.000039152,0.000053649},
{0.000012280,-0.000010401,-0.000028673,-0.000017471,-0.000030131,-0.000010096,-0.000015888,-0.000019526,-0.000026595,-0.000014445,-0.000014275,-0.000012686,-0.000015447,-0.000018451,-0.000017397,-0.000019796,-0.000007890,0.000000766,-0.000001204,0.000009713,0.000000781,0.000002784,0.000045726,0.000033621},
{-0.000041753,-0.000027449,-0.000015758,-0.000016074,-0.000009804,-0.000029746,-0.000041169,-0.000032995,-0.000026326,-0.000019927,-0.000028752,-0.000022091,-0.000023689,-0.000011129,-0.000016366,-0.000037100,-0.000030182,-0.000009746,-0.000028765,-0.000022014,-0.000023757,-0.000047700,-0.000036039,-0.000074981},
{-0.000046874,-0.000023197,-0.000033757,-0.000045562,-0.000036265,-0.000030706,-0.000043237,-0.000029082,-0.000023469,-0.000026530,-0.000038889,-0.000036461,-0.000025450,-0.000020252,-0.000038934,-0.000050713,-0.000053671,-0.000038225,-0.000039176,-0.000023822,-0.000060444,-0.000079007,-0.000102585,-0.000088537},
{-0.000064713,-0.000036411,0.000000823,-0.000019679,-0.000016198,-0.000035611,-0.000048894,-0.000032577,-0.000024600,-0.000044273,-0.000026492,-0.000026286,-0.000040733,-0.000022286,-0.000021394,-0.000045521,-0.000051253,-0.000053525,-0.000062427,-0.000048543,-0.000044449,-0.000058395,-0.000079429,-0.000144538}};

//==========================================================================================================================
const double rochcor2016::dmavg[16][24]={{0.025558404,0.025264477,0.025336534,0.024901780,0.024839959,0.024575018,0.024653591,0.024781451,0.024964011,0.025205356,0.025119858,0.025244644,0.025248807,0.025152029,0.025157468,0.025028802,0.024883908,0.024611394,0.024665495,0.024721916,0.024777602,0.025165840,0.025287052,0.025612981},
{0.025945974,0.025309894,0.025593587,0.025038483,0.024772797,0.024749196,0.024764693,0.024968169,0.024838901,0.025161559,0.025280411,0.025199020,0.025350281,0.025242873,0.024892469,0.025074054,0.024732678,0.024699862,0.024697707,0.024657278,0.025016757,0.025243839,0.025734510,0.025869169},
{0.025537461,0.025479550,0.025032169,0.024928265,0.024894102,0.024701684,0.024770317,0.024952654,0.025036837,0.025112983,0.025320745,0.025409140,0.025509610,0.025035201,0.025072982,0.024812453,0.024819501,0.024871174,0.024639191,0.024464597,0.024829375,0.024772289,0.025540839,0.025891764},
{0.025506680,0.025294746,0.025065255,0.024879992,0.024661292,0.024681633,0.024970919,0.024967286,0.024975287,0.025128938,0.025108205,0.025283416,0.025509219,0.025225175,0.024975150,0.025037455,0.024948975,0.024567077,0.024587146,0.024543908,0.024912776,0.025246834,0.025868587,0.025781327},
{0.025770871,0.025382912,0.025119811,0.024780336,0.024745466,0.024628037,0.024917156,0.024804988,0.024995748,0.025108605,0.025174433,0.025473852,0.025353214,0.025262317,0.025028381,0.024987383,0.024890251,0.024983895,0.024694256,0.024821354,0.024837999,0.024954304,0.025288991,0.025375216},
{0.025570548,0.025729214,0.025143066,0.025041782,0.024666756,0.024769393,0.024725667,0.024925555,0.025018735,0.024894657,0.025175064,0.025298330,0.025327514,0.025238496,0.025189022,0.025005457,0.024870270,0.024701012,0.024674419,0.024676002,0.024901629,0.025202585,0.025118715,0.025841624},
{0.025761939,0.025570421,0.025030377,0.024855174,0.024640744,0.024598279,0.024748574,0.024772518,0.024747132,0.025291924,0.025283299,0.025256229,0.025230289,0.025259252,0.025104538,0.024883031,0.024947276,0.024728841,0.024679185,0.024896759,0.024859456,0.025236969,0.025650006,0.025593521},
{0.025478931,0.025688531,0.025023873,0.024924355,0.024819567,0.024557972,0.024666963,0.024703283,0.024972421,0.025064858,0.025282793,0.025453612,0.025114865,0.025123283,0.025131484,0.024933845,0.024852345,0.024709297,0.024713554,0.024681071,0.025019022,0.025142142,0.025698864,0.025669723},
{0.025659565,0.025338470,0.025373812,0.024953289,0.024794386,0.024781646,0.024633515,0.024991190,0.025071803,0.025065414,0.025236919,0.025381258,0.025421761,0.025394107,0.024983688,0.024852494,0.024778758,0.024792210,0.024738162,0.024698796,0.024932373,0.025448477,0.025882813,0.026086373},
{0.025701911,0.025145471,0.025068455,0.024941849,0.024894060,0.024658414,0.024534874,0.024719298,0.024940260,0.025019765,0.025203432,0.025314399,0.025382764,0.025162420,0.025078010,0.025104380,0.024895917,0.024705412,0.024670738,0.024792929,0.024777487,0.025233587,0.025328878,0.025723355},
{0.025925623,0.025115492,0.025255062,0.024884685,0.024970479,0.024842853,0.024851836,0.025115156,0.025117317,0.024993514,0.025391347,0.025347541,0.025337956,0.025331840,0.024970237,0.024866202,0.024528324,0.025129362,0.024822770,0.024754879,0.024719871,0.025092578,0.025544745,0.025968644},
{0.025724711,0.025684899,0.025109971,0.024898033,0.024687962,0.024763065,0.024777461,0.024943756,0.024906856,0.024880884,0.025334679,0.025185121,0.025273883,0.025108363,0.025201408,0.024847969,0.024868983,0.024740880,0.024715949,0.024668291,0.025053458,0.024948258,0.025375278,0.025755420},
{0.025683246,0.025546181,0.025231961,0.025074281,0.024775219,0.024933366,0.024790563,0.024921164,0.024961473,0.024936978,0.025099728,0.025278086,0.025246985,0.025445596,0.025353720,0.024875181,0.024778937,0.024881186,0.024645315,0.024857661,0.024865555,0.025094224,0.025625249,0.025679052},
{0.025783120,0.025612848,0.025077174,0.024765053,0.024783548,0.024621583,0.024792763,0.024932378,0.025002422,0.024851548,0.025183826,0.025208691,0.025188589,0.025186307,0.025067799,0.024804839,0.024888481,0.024634821,0.024859527,0.024820620,0.024870456,0.025133404,0.025358995,0.025746417},
{0.025736243,0.025935059,0.024968434,0.024845354,0.024740575,0.024598357,0.024756363,0.024808561,0.025084902,0.025049562,0.025199911,0.025376242,0.025281838,0.025178134,0.025268367,0.024866470,0.024952166,0.024647384,0.024645547,0.024932486,0.024870602,0.024990861,0.025444338,0.025664271},
{0.025587751,0.025640043,0.025202042,0.024832996,0.024874559,0.024799803,0.024823610,0.024891514,0.024938149,0.024991878,0.025201441,0.025274832,0.025274287,0.025052290,0.025034802,0.024766191,0.024764832,0.024713895,0.024727664,0.024620462,0.024800720,0.025108672,0.025623487,0.025759928}};
const double rochcor2016::dpavg[16][24]={{0.025732247,0.025201924,0.025401881,0.024850990,0.024802866,0.024740340,0.024824766,0.024839656,0.024861916,0.025069292,0.025260444,0.025319173,0.025431454,0.025193138,0.025001083,0.024925625,0.024892254,0.024824836,0.024685233,0.024832456,0.024867448,0.025112976,0.025476851,0.025816990},
{0.026056116,0.025382254,0.025212395,0.025258458,0.024989088,0.024521382,0.024526675,0.024708895,0.024870119,0.025251257,0.025222675,0.025352458,0.025413181,0.025234887,0.025075266,0.024953089,0.024762991,0.024767562,0.024770017,0.024790677,0.024849272,0.025190810,0.025352716,0.025748112},
{0.025565423,0.025301115,0.025117505,0.025005303,0.024664326,0.024719115,0.024656449,0.024808771,0.025045548,0.024943938,0.025298990,0.025340183,0.025385063,0.025189798,0.025044732,0.024874905,0.024672277,0.024754930,0.024680975,0.024635542,0.024794571,0.025140919,0.025795384,0.025782219},
{0.025641139,0.025267689,0.024944762,0.024753558,0.024867568,0.024781286,0.024761726,0.024854381,0.024974177,0.025141619,0.025139619,0.025438660,0.025560035,0.025061974,0.025037692,0.024817939,0.024803905,0.024641247,0.024514783,0.024763066,0.024744026,0.025214515,0.025585427,0.025646482},
{0.025831020,0.025375745,0.025275291,0.025104830,0.024624833,0.024611145,0.024813762,0.024756085,0.024886614,0.025091151,0.025420690,0.025240196,0.025511683,0.025322057,0.025025051,0.025047222,0.024857433,0.024582996,0.024861826,0.024760633,0.024698369,0.025030369,0.025525411,0.025673793},
{0.025724922,0.025442153,0.025246284,0.024912728,0.024726202,0.024567985,0.024770496,0.024827107,0.025032169,0.025181952,0.025154070,0.025488673,0.025317308,0.025261212,0.025050697,0.024737091,0.024822015,0.024478626,0.024557095,0.024852782,0.024883017,0.025419712,0.025527090,0.025667276},
{0.026015713,0.025728982,0.025298923,0.024816078,0.024975811,0.024825669,0.024765935,0.024711141,0.024921743,0.025005690,0.025392918,0.025333196,0.025319310,0.025218020,0.025067736,0.024926810,0.024947859,0.024764260,0.024659261,0.024875729,0.024876848,0.025374277,0.025490970,0.025746360},
{0.025628613,0.025656602,0.025428310,0.024972135,0.024890843,0.024721848,0.024541090,0.024951315,0.025118950,0.024993728,0.025181853,0.025397696,0.025417199,0.025090510,0.025074923,0.024790769,0.024952025,0.024366782,0.024754228,0.024881037,0.024999088,0.025308241,0.025529178,0.025851060},
{0.026141923,0.025603606,0.025554390,0.025067079,0.024844360,0.024730216,0.024795069,0.024763551,0.024921068,0.025184462,0.025185362,0.025208181,0.025478302,0.025361347,0.025273094,0.024800360,0.024708218,0.024784786,0.024754451,0.024832175,0.024839700,0.025115787,0.025740746,0.025893600},
{0.025705505,0.025566935,0.025381953,0.024917387,0.024688378,0.024902582,0.024744888,0.024868281,0.024865522,0.025038407,0.025150127,0.025302709,0.025391004,0.024995821,0.025024893,0.025036667,0.024825808,0.024708842,0.024647495,0.024724445,0.025041193,0.025082893,0.025478342,0.025820532},
{0.026026761,0.025354245,0.025280699,0.025051816,0.024962639,0.024641527,0.024762228,0.024706958,0.025013459,0.025047128,0.025484593,0.025575678,0.025165677,0.025235134,0.025013177,0.025088925,0.024599316,0.024915072,0.024762686,0.024780044,0.025116647,0.025271048,0.025720110,0.025730062},
{0.025885135,0.025613152,0.025170938,0.025042719,0.024828196,0.024811731,0.024675307,0.024872726,0.024914044,0.025135480,0.024933110,0.025261246,0.025591318,0.025339682,0.025107328,0.024875753,0.025025095,0.024885507,0.024466649,0.024929710,0.024806668,0.025186013,0.025621186,0.025778068},
{0.025719849,0.025407253,0.024991460,0.025006451,0.024948076,0.024486886,0.024630385,0.024664519,0.024996182,0.025128650,0.025331273,0.025508449,0.025484811,0.025364999,0.025279917,0.024878147,0.024929991,0.024819277,0.024492201,0.024995264,0.024990626,0.025499498,0.025575481,0.025685841},
{0.025905087,0.025649331,0.025320311,0.024776520,0.024842899,0.024805672,0.024687116,0.024775092,0.024894752,0.025068254,0.025265928,0.025272749,0.025286924,0.025261177,0.024887898,0.024894492,0.024770872,0.024782680,0.024616310,0.024825930,0.024976158,0.025327727,0.025544511,0.026020029},
{0.025847166,0.025339521,0.025015022,0.024890989,0.024730382,0.024668392,0.024710399,0.024950102,0.024845186,0.025082880,0.025105393,0.025240457,0.025451876,0.025260851,0.025047910,0.024935529,0.024935042,0.024803974,0.024865158,0.024830661,0.024817195,0.025303445,0.025589594,0.026039039},
{0.026027526,0.025420082,0.025218528,0.024872047,0.024609255,0.024662385,0.024702202,0.024729494,0.025021130,0.025096391,0.025090363,0.025385010,0.025563766,0.025171515,0.025135011,0.024965501,0.024831256,0.024743853,0.024874772,0.024738100,0.024969503,0.025280766,0.025237665,0.026089737}};
const double rochcor2016::mmavg[16][24]={{0.025458805,0.025131662,0.025028531,0.024780566,0.024572391,0.024588932,0.024599394,0.024910693,0.025055953,0.025248590,0.025346946,0.025397918,0.025436797,0.025348409,0.025195837,0.024993056,0.024805210,0.024712471,0.024720400,0.024753534,0.024735360,0.024902757,0.025157093,0.025523225},
{0.025389156,0.025238500,0.024968486,0.024784073,0.024639502,0.024643651,0.024842790,0.024850419,0.025068861,0.025176345,0.025313538,0.025457101,0.025501452,0.025390128,0.025223776,0.024943040,0.024837261,0.024640078,0.024616584,0.024631107,0.024614512,0.024955220,0.025126905,0.025441283},
{0.025267822,0.025261707,0.024892959,0.024765091,0.024655105,0.024673564,0.024763780,0.024976119,0.025060614,0.025123504,0.025290003,0.025453156,0.025459393,0.025316262,0.025111013,0.024959092,0.024742696,0.024679082,0.024554007,0.024564051,0.024755843,0.025052170,0.025154097,0.025583722},
{0.025428961,0.025246007,0.025057621,0.024655894,0.024664089,0.024548505,0.024633906,0.024792621,0.024853540,0.025225087,0.025448507,0.025546464,0.025553124,0.025309204,0.025308719,0.024839657,0.024788310,0.024695779,0.024663498,0.024688269,0.024717451,0.024915027,0.025168929,0.025573446},
{0.025454526,0.025225482,0.024860697,0.024678043,0.024666041,0.024652852,0.024786050,0.024899403,0.025085028,0.025189706,0.025339090,0.025430208,0.025455640,0.025295621,0.025148270,0.025062287,0.024839035,0.024775239,0.024714750,0.024542500,0.024632031,0.024946122,0.025161386,0.025440778},
{0.025512674,0.025256800,0.024885194,0.024730897,0.024658128,0.024665822,0.024746580,0.024690664,0.024890226,0.025275884,0.025264518,0.025369328,0.025481333,0.025177660,0.025144455,0.024883644,0.024897190,0.024736108,0.024677225,0.024606744,0.024748549,0.024936886,0.025204854,0.025557035},
{0.025610661,0.025077216,0.025012902,0.024755473,0.024633680,0.024586943,0.024687774,0.024733122,0.024960168,0.025168577,0.025355816,0.025391850,0.025562206,0.025298695,0.025161867,0.024919172,0.024942865,0.024681271,0.024727700,0.024704038,0.024841484,0.024905995,0.025182957,0.025429828},
{0.025601425,0.025193002,0.024945226,0.024818158,0.024751915,0.024574496,0.024819890,0.024839360,0.024983091,0.025093793,0.025283627,0.025394489,0.025503614,0.025306918,0.025216970,0.024988951,0.024791298,0.024750659,0.024698734,0.024689905,0.024815761,0.024950876,0.025259061,0.025650253},
{0.025551413,0.025325902,0.024972697,0.024941683,0.024704763,0.024654560,0.024702379,0.024828190,0.025008713,0.025213536,0.025197650,0.025310361,0.025314569,0.025316732,0.025083006,0.025021805,0.025055322,0.024706032,0.024642797,0.024895780,0.024834161,0.025054448,0.025383386,0.025535225},
{0.025613723,0.025179172,0.024974568,0.024747545,0.024778212,0.024780797,0.024826203,0.024813154,0.024950534,0.025185712,0.025199383,0.025392405,0.025373535,0.025352531,0.025131473,0.024938878,0.024844073,0.024750969,0.024746942,0.024735875,0.024765178,0.024957140,0.025249104,0.025415877},
{0.025404784,0.025304065,0.025172621,0.024874607,0.024711883,0.024664642,0.024675462,0.024889242,0.024963463,0.025206473,0.025438813,0.025346956,0.025430702,0.025269265,0.025105547,0.024987587,0.024870094,0.024796147,0.024610600,0.024663591,0.024766956,0.024944150,0.025116208,0.025602498},
{0.025515950,0.025368945,0.025073306,0.024680225,0.024660852,0.024731587,0.024755594,0.024820933,0.024936465,0.025145580,0.025367579,0.025418270,0.025411058,0.025268529,0.025092924,0.025012111,0.024972395,0.024826226,0.024662198,0.024698136,0.024758804,0.024887809,0.025244951,0.025643639},
{0.025505109,0.025226815,0.025048418,0.024745409,0.024684448,0.024650452,0.024705537,0.024804271,0.025008977,0.025222498,0.025341663,0.025365184,0.025378073,0.025460480,0.025139490,0.024963288,0.024934207,0.024678532,0.024633606,0.024673801,0.024818523,0.025008323,0.025276975,0.025383635},
{0.025653522,0.025314071,0.024931759,0.024713399,0.024700565,0.024699737,0.024722126,0.024853192,0.024932563,0.025052847,0.025271886,0.025408933,0.025395090,0.025272927,0.025052581,0.024965063,0.024809225,0.024735059,0.024588029,0.024548668,0.024794109,0.024991092,0.025218257,0.025420860},
{0.025439357,0.025237757,0.025009570,0.024797853,0.024735321,0.024718072,0.024777543,0.024824041,0.025015041,0.025226142,0.025382165,0.025317720,0.025348788,0.025309393,0.025109041,0.024983815,0.024921707,0.024714392,0.024704062,0.024668235,0.024863192,0.024948842,0.025240603,0.025556680},
{0.025569446,0.025309356,0.024972403,0.024784395,0.024629557,0.024713524,0.024699288,0.024742391,0.024959606,0.025267035,0.025215543,0.025356031,0.025417304,0.025268741,0.025152004,0.024916678,0.024952941,0.024747796,0.024574325,0.024668425,0.024748870,0.024950989,0.025264487,0.025560359}};
const double rochcor2016::mpavg[16][24]={{0.025526631,0.025204942,0.025067672,0.024761568,0.024749427,0.024684930,0.024688210,0.024873674,0.025132703,0.025157759,0.025332839,0.025487255,0.025437930,0.025392013,0.025201059,0.024947196,0.024946673,0.024788102,0.024767251,0.024767177,0.024831879,0.025087517,0.025330880,0.025516918},
{0.025436736,0.025339492,0.024982425,0.024686613,0.024702255,0.024648166,0.024784052,0.024875353,0.025046116,0.025175142,0.025302928,0.025488612,0.025498813,0.025300916,0.025267943,0.024954213,0.024774450,0.024710405,0.024662504,0.024710354,0.024840226,0.024889730,0.025175452,0.025699850},
{0.025540408,0.025123988,0.024975240,0.024818258,0.024632145,0.024707514,0.024673991,0.024947935,0.025016525,0.025127452,0.025303347,0.025449168,0.025496090,0.025374124,0.025305534,0.025017863,0.024712159,0.024681991,0.024556603,0.024678723,0.024750678,0.025095990,0.025364852,0.025511024},
{0.025584057,0.025327730,0.025070940,0.024754902,0.024724121,0.024646230,0.024816551,0.024906120,0.025026634,0.025171476,0.025324777,0.025517861,0.025451825,0.025448012,0.025168005,0.025048308,0.024911835,0.024766247,0.024634405,0.024746581,0.024783576,0.024872140,0.025299175,0.025451339},
{0.025662618,0.025345020,0.024992199,0.024814288,0.024621896,0.024647359,0.024713659,0.024905552,0.025034290,0.025152763,0.025370913,0.025341863,0.025497319,0.025401679,0.025090100,0.024944143,0.024850833,0.024799342,0.024687266,0.024577701,0.024790361,0.024993240,0.025409538,0.025482482},
{0.025574005,0.025145878,0.025008872,0.024813328,0.024645494,0.024551292,0.024791732,0.024819388,0.025073032,0.025086264,0.025371034,0.025438309,0.025410963,0.025301299,0.025186373,0.024959682,0.024848014,0.024720064,0.024649621,0.024640251,0.024812740,0.025019378,0.025356744,0.025687503},
{0.025564425,0.025216971,0.025063043,0.024770734,0.024780487,0.024761276,0.024718684,0.024927607,0.025041479,0.025209585,0.025284265,0.025420286,0.025496948,0.025373247,0.025072937,0.025097693,0.024827333,0.024661874,0.024669971,0.024679704,0.024884703,0.025017442,0.025287436,0.025683539},
{0.025678886,0.025268237,0.024932784,0.024723472,0.024658139,0.024716519,0.024603151,0.024760452,0.024978636,0.025161224,0.025320517,0.025423592,0.025438784,0.025322630,0.025162756,0.025015557,0.024753690,0.024804508,0.024684600,0.024716044,0.024738873,0.024958288,0.025370587,0.025571973},
{0.025698107,0.025438103,0.024990345,0.024732668,0.024715487,0.024643308,0.024737667,0.024916860,0.025032820,0.025175285,0.025415789,0.025439099,0.025380298,0.025358431,0.024987345,0.024899270,0.024803186,0.024687228,0.024656247,0.024623160,0.024813253,0.024939027,0.025274801,0.025772122},
{0.025524371,0.025342392,0.025061569,0.024878375,0.024696227,0.024694689,0.024774483,0.024828365,0.025036944,0.025136330,0.025344542,0.025447786,0.025554632,0.025229763,0.025174346,0.025049104,0.024815948,0.024730239,0.024649247,0.024726495,0.024945174,0.025158626,0.025415424,0.025442940},
{0.025514933,0.025437047,0.025127011,0.024890201,0.024581714,0.024675689,0.024724725,0.024798416,0.024958161,0.025042732,0.025425955,0.025398535,0.025435611,0.025381800,0.025084402,0.025026319,0.024953608,0.024693601,0.024673295,0.024679408,0.024794184,0.024982386,0.025279962,0.025359161},
{0.025528907,0.025356944,0.025050552,0.024838183,0.024570550,0.024658334,0.024581641,0.024785664,0.025005226,0.025180267,0.025190817,0.025448298,0.025528290,0.025348606,0.025161500,0.024841035,0.024776656,0.024766540,0.024688387,0.024544343,0.024797723,0.025019607,0.025051706,0.025659207},
{0.025668285,0.025353494,0.025152071,0.024766037,0.024650302,0.024773953,0.024715181,0.024857688,0.025011623,0.025158313,0.025303798,0.025450155,0.025435664,0.025346822,0.025232372,0.024969769,0.024915121,0.024777951,0.024709406,0.024786683,0.024843525,0.025087349,0.025273249,0.025513274},
{0.025581318,0.025336673,0.025064368,0.024833902,0.024767704,0.024659101,0.024758863,0.024794400,0.024979445,0.025162999,0.025270871,0.025520713,0.025511858,0.025266773,0.025177483,0.024950118,0.024811747,0.024691061,0.024664287,0.024818657,0.024829729,0.025005095,0.025309844,0.025660301},
{0.025540576,0.025349343,0.025104470,0.024844930,0.024694997,0.024687327,0.024760809,0.024875396,0.024967168,0.025154299,0.025312854,0.025434950,0.025440576,0.025212354,0.025142761,0.024988968,0.024892105,0.024633031,0.024602283,0.024770655,0.024735910,0.025033409,0.025268514,0.025562496},
{0.025796493,0.025385282,0.025105934,0.024885459,0.024724094,0.024531660,0.024899098,0.024822090,0.025042649,0.025076204,0.025442145,0.025474377,0.025546913,0.025366920,0.025183401,0.025025580,0.024892794,0.024774056,0.024595163,0.024642532,0.024720980,0.025053273,0.025370313,0.025652193}};

//==========================================================================================================================
const double rochcor2016::dcor_bfer[16][24]={{0.000119612,0.000113702,0.000080013,0.000075369,0.000078105,0.000074931,0.000072932,0.000070517,0.000068008,0.000067778,0.000068656,0.000067960,0.000068222,0.000068665,0.000067898,0.000068889,0.000071453,0.000073457,0.000076188,0.000078708,0.000074391,0.000080328,0.000111562,0.000117979},
{0.000120958,0.000111988,0.000080854,0.000075329,0.000077794,0.000076762,0.000072459,0.000070652,0.000068923,0.000068130,0.000068393,0.000068514,0.000067821,0.000068485,0.000068699,0.000068614,0.000070365,0.000072252,0.000074739,0.000077818,0.000074212,0.000080510,0.000112263,0.000119880},
{0.000123751,0.000113473,0.000082493,0.000075587,0.000079524,0.000075397,0.000074613,0.000071751,0.000069685,0.000068670,0.000069551,0.000069511,0.000068336,0.000070109,0.000068251,0.000068981,0.000071562,0.000074352,0.000075046,0.000079001,0.000074043,0.000080320,0.000111904,0.000122507},
{0.000120674,0.000112083,0.000080808,0.000075134,0.000078766,0.000076232,0.000073226,0.000072779,0.000068871,0.000069227,0.000070376,0.000069108,0.000068678,0.000070515,0.000067990,0.000069197,0.000073700,0.000073094,0.000075788,0.000079394,0.000074697,0.000080814,0.000112779,0.000121966},
{0.000121133,0.000112403,0.000080338,0.000073867,0.000077967,0.000075465,0.000074159,0.000071646,0.000070183,0.000069326,0.000071373,0.000069532,0.000069333,0.000070160,0.000068028,0.000070659,0.000072699,0.000078266,0.000077295,0.000078877,0.000074245,0.000081128,0.000111634,0.000120744},
{0.000118069,0.000110117,0.000080231,0.000075720,0.000077500,0.000074642,0.000072946,0.000070350,0.000068203,0.000067720,0.000069185,0.000068350,0.000068196,0.000068981,0.000067631,0.000067977,0.000071473,0.000073145,0.000074213,0.000077892,0.000074566,0.000080392,0.000111897,0.000122203},
{0.000119816,0.000112502,0.000081096,0.000075144,0.000077969,0.000074779,0.000072388,0.000070660,0.000067896,0.000068407,0.000069811,0.000068917,0.000068991,0.000068573,0.000067325,0.000068685,0.000071354,0.000072535,0.000075089,0.000077949,0.000074732,0.000080809,0.000110987,0.000119978},
{0.000119298,0.000113200,0.000080885,0.000075511,0.000078835,0.000074583,0.000073392,0.000071011,0.000069908,0.000067275,0.000069409,0.000068550,0.000067487,0.000069545,0.000067874,0.000069013,0.000071777,0.000073492,0.000074650,0.000078369,0.000074366,0.000079422,0.000112050,0.000118109},
{0.000117654,0.000113807,0.000080801,0.000075121,0.000077957,0.000075212,0.000071950,0.000071507,0.000068371,0.000067568,0.000068807,0.000068001,0.000068581,0.000070042,0.000067286,0.000068052,0.000070616,0.000071988,0.000074716,0.000077704,0.000074256,0.000080508,0.000110649,0.000119343},
{0.000120334,0.000113258,0.000081010,0.000075371,0.000079677,0.000073836,0.000072954,0.000072811,0.000068555,0.000067546,0.000069956,0.000068182,0.000068386,0.000067924,0.000067612,0.000069205,0.000070525,0.000072762,0.000075327,0.000077940,0.000074095,0.000080031,0.000111773,0.000119050},
{0.000122773,0.000114301,0.000080932,0.000075356,0.000077988,0.000074087,0.000074303,0.000074865,0.000068674,0.000067542,0.000080540,0.000068578,0.000068271,0.000068264,0.000068232,0.000068172,0.000069834,0.000072635,0.000074803,0.000077973,0.000074332,0.000080811,0.000113922,0.000120481},
{0.000119160,0.000113269,0.000080779,0.000073830,0.000078604,0.000075862,0.000071882,0.000072236,0.000068554,0.000067804,0.000071731,0.000068437,0.000068399,0.000080011,0.000067975,0.000068195,0.000071878,0.000072348,0.000075540,0.000078974,0.000075513,0.000078998,0.000112238,0.000118718},
{0.000119911,0.000111616,0.000079196,0.000074342,0.000078305,0.000074901,0.000072846,0.000071928,0.000068997,0.000068590,0.000069793,0.000069081,0.000069362,0.000083918,0.000069225,0.000069524,0.000073143,0.000074476,0.000076123,0.000079588,0.000075061,0.000080660,0.000113418,0.000120248},
{0.000117903,0.000111899,0.000079539,0.000074454,0.000078588,0.000074495,0.000071919,0.000071071,0.000068276,0.000067296,0.000067644,0.000067812,0.000068622,0.000068208,0.000067293,0.000068968,0.000070354,0.000072776,0.000074058,0.000078409,0.000074728,0.000081616,0.000112625,0.000121614},
{0.000118530,0.000113448,0.000081706,0.000074595,0.000077928,0.000074540,0.000073386,0.000071299,0.000069139,0.000068376,0.000068592,0.000068470,0.000068287,0.000067973,0.000067456,0.000068281,0.000070882,0.000072390,0.000077504,0.000078849,0.000076781,0.000080029,0.000111701,0.000120334},
{0.000119924,0.000114300,0.000081271,0.000075646,0.000077766,0.000074579,0.000072920,0.000071324,0.000068642,0.000068170,0.000069336,0.000068777,0.000068503,0.000068267,0.000067747,0.000068656,0.000070961,0.000073218,0.000074989,0.000078007,0.000073559,0.000080515,0.000112409,0.000119249}};
const double rochcor2016::dcor_maer[16][24]={{0.000119612,0.000113702,0.000080013,0.000075369,0.000078105,0.000074931,0.000072932,0.000070517,0.000068008,0.000067778,0.000068656,0.000067960,0.000068222,0.000068665,0.000067898,0.000068889,0.000071453,0.000073457,0.000076188,0.000078708,0.000074391,0.000080328,0.000111562,0.000117979},
{0.000120958,0.000111988,0.000080854,0.000075329,0.000077794,0.000076762,0.000072459,0.000070652,0.000068923,0.000068130,0.000068393,0.000068514,0.000067821,0.000068485,0.000068699,0.000068614,0.000070365,0.000072252,0.000074739,0.000077818,0.000074212,0.000080510,0.000112263,0.000119880},
{0.000123751,0.000113473,0.000082493,0.000075587,0.000079524,0.000075397,0.000074613,0.000071751,0.000069685,0.000068670,0.000069551,0.000069511,0.000068336,0.000070109,0.000068251,0.000068981,0.000071562,0.000074352,0.000075046,0.000079001,0.000074043,0.000080320,0.000111904,0.000122507},
{0.000120674,0.000112083,0.000080808,0.000075134,0.000078766,0.000076232,0.000073226,0.000072779,0.000068871,0.000069227,0.000070376,0.000069108,0.000068678,0.000070515,0.000067990,0.000069197,0.000073700,0.000073094,0.000075788,0.000079394,0.000074697,0.000080814,0.000112779,0.000121966},
{0.000121133,0.000112403,0.000080338,0.000073867,0.000077967,0.000075465,0.000074159,0.000071646,0.000070183,0.000069326,0.000071373,0.000069532,0.000069333,0.000070160,0.000068028,0.000070659,0.000072699,0.000078266,0.000077295,0.000078877,0.000074245,0.000081128,0.000111634,0.000120744},
{0.000118069,0.000110117,0.000080231,0.000075720,0.000077500,0.000074642,0.000072946,0.000070350,0.000068203,0.000067720,0.000069185,0.000068350,0.000068196,0.000068981,0.000067631,0.000067977,0.000071473,0.000073145,0.000074213,0.000077892,0.000074566,0.000080392,0.000111897,0.000122203},
{0.000119816,0.000112502,0.000081096,0.000075144,0.000077969,0.000074779,0.000072388,0.000070660,0.000067896,0.000068407,0.000069811,0.000068917,0.000068991,0.000068573,0.000067325,0.000068685,0.000071354,0.000072535,0.000075089,0.000077949,0.000074732,0.000080809,0.000110987,0.000119978},
{0.000119298,0.000113200,0.000080885,0.000075511,0.000078835,0.000074583,0.000073392,0.000071011,0.000069908,0.000067275,0.000069409,0.000068550,0.000067487,0.000069545,0.000067874,0.000069013,0.000071777,0.000073492,0.000074650,0.000078369,0.000074366,0.000079422,0.000112050,0.000118109},
{0.000117654,0.000113807,0.000080801,0.000075121,0.000077957,0.000075212,0.000071950,0.000071507,0.000068371,0.000067568,0.000068807,0.000068001,0.000068581,0.000070042,0.000067286,0.000068052,0.000070616,0.000071988,0.000074716,0.000077704,0.000074256,0.000080508,0.000110649,0.000119343},
{0.000120334,0.000113258,0.000081010,0.000075371,0.000079677,0.000073836,0.000072954,0.000072811,0.000068555,0.000067546,0.000069956,0.000068182,0.000068386,0.000067924,0.000067612,0.000069205,0.000070525,0.000072762,0.000075327,0.000077940,0.000074095,0.000080031,0.000111773,0.000119050},
{0.000122773,0.000114301,0.000080932,0.000075356,0.000077988,0.000074087,0.000074303,0.000074865,0.000068674,0.000067542,0.000080540,0.000068578,0.000068271,0.000068264,0.000068232,0.000068172,0.000069834,0.000072635,0.000074803,0.000077973,0.000074332,0.000080811,0.000113922,0.000120481},
{0.000119160,0.000113269,0.000080779,0.000073830,0.000078604,0.000075862,0.000071882,0.000072236,0.000068554,0.000067804,0.000071731,0.000068437,0.000068399,0.000080011,0.000067975,0.000068195,0.000071878,0.000072348,0.000075540,0.000078974,0.000075513,0.000078998,0.000112238,0.000118718},
{0.000119911,0.000111616,0.000079196,0.000074342,0.000078305,0.000074901,0.000072846,0.000071928,0.000068997,0.000068590,0.000069793,0.000069081,0.000069362,0.000083918,0.000069225,0.000069524,0.000073143,0.000074476,0.000076123,0.000079588,0.000075061,0.000080660,0.000113418,0.000120248},
{0.000117903,0.000111899,0.000079539,0.000074454,0.000078588,0.000074495,0.000071919,0.000071071,0.000068276,0.000067296,0.000067644,0.000067812,0.000068622,0.000068208,0.000067293,0.000068968,0.000070354,0.000072776,0.000074058,0.000078409,0.000074728,0.000081616,0.000112625,0.000121614},
{0.000118530,0.000113448,0.000081706,0.000074595,0.000077928,0.000074540,0.000073386,0.000071299,0.000069139,0.000068376,0.000068592,0.000068470,0.000068287,0.000067973,0.000067456,0.000068281,0.000070882,0.000072390,0.000077504,0.000078849,0.000076781,0.000080029,0.000111701,0.000120334},
{0.000119924,0.000114300,0.000081271,0.000075646,0.000077766,0.000074579,0.000072920,0.000071324,0.000068642,0.000068170,0.000069336,0.000068777,0.000068503,0.000068267,0.000067747,0.000068656,0.000070961,0.000073218,0.000074989,0.000078007,0.000073559,0.000080515,0.000112409,0.000119249}};
const double rochcor2016::mcor_bfer[16][24]={{0.000092771,0.000088681,0.000064113,0.000060875,0.000063784,0.000060757,0.000058737,0.000058439,0.000056068,0.000055746,0.000056529,0.000056325,0.000055354,0.000055880,0.000055516,0.000056643,0.000058242,0.000058987,0.000061579,0.000063931,0.000060212,0.000064048,0.000088597,0.000093395},
{0.000093563,0.000088591,0.000064854,0.000060252,0.000063041,0.000062352,0.000059192,0.000057830,0.000056494,0.000055672,0.000056436,0.000055954,0.000055699,0.000055803,0.000056584,0.000055966,0.000058072,0.000058751,0.000061248,0.000063644,0.000060568,0.000064587,0.000088141,0.000092461},
{0.000093594,0.000088036,0.000065099,0.000060793,0.000063858,0.000061370,0.000059617,0.000058115,0.000056940,0.000055523,0.000056469,0.000056281,0.000056254,0.000056839,0.000056135,0.000056881,0.000058625,0.000060199,0.000061115,0.000063776,0.000059799,0.000064637,0.000087995,0.000093325},
{0.000094472,0.000089567,0.000064256,0.000059783,0.000064088,0.000061430,0.000060486,0.000058749,0.000056632,0.000056021,0.000057022,0.000056418,0.000055873,0.000056921,0.000055982,0.000056197,0.000058489,0.000059275,0.000061465,0.000064259,0.000061088,0.000064946,0.000087700,0.000093951},
{0.000094096,0.000088753,0.000064382,0.000060243,0.000063425,0.000061267,0.000059641,0.000057986,0.000056863,0.000056210,0.000057467,0.000056430,0.000056141,0.000056788,0.000056093,0.000057394,0.000059105,0.000059621,0.000061768,0.000064246,0.000060079,0.000064821,0.000087804,0.000093154},
{0.000094242,0.000087793,0.000065278,0.000060948,0.000063534,0.000061155,0.000059168,0.000057102,0.000055571,0.000055832,0.000055795,0.000055274,0.000055794,0.000056329,0.000055240,0.000055893,0.000057847,0.000058561,0.000061161,0.000063502,0.000059630,0.000064702,0.000087976,0.000093466},
{0.000093348,0.000088973,0.000064695,0.000060570,0.000063601,0.000060769,0.000058725,0.000058291,0.000055756,0.000055528,0.000056417,0.000055487,0.000056320,0.000055428,0.000055252,0.000056598,0.000057784,0.000059051,0.000061332,0.000062863,0.000060086,0.000065672,0.000088446,0.000093928},
{0.000093845,0.000089177,0.000065064,0.000060850,0.000063316,0.000060706,0.000059984,0.000058855,0.000056718,0.000055658,0.000056853,0.000055549,0.000055543,0.000056404,0.000055099,0.000056686,0.000058326,0.000059746,0.000061121,0.000063634,0.000060710,0.000064001,0.000088762,0.000093872},
{0.000092051,0.000089961,0.000064671,0.000060256,0.000063702,0.000060022,0.000058830,0.000058471,0.000056187,0.000055920,0.000056371,0.000056151,0.000055486,0.000056371,0.000055819,0.000056061,0.000058455,0.000059053,0.000060820,0.000063608,0.000060404,0.000064592,0.000088213,0.000092383},
{0.000094503,0.000088789,0.000064938,0.000060152,0.000063596,0.000060065,0.000058868,0.000057574,0.000056526,0.000055224,0.000056850,0.000055708,0.000055812,0.000055300,0.000055363,0.000056369,0.000057674,0.000058786,0.000060327,0.000064925,0.000059715,0.000064487,0.000088023,0.000092915},
{0.000091884,0.000087829,0.000064524,0.000060502,0.000063951,0.000060595,0.000059026,0.000058321,0.000055742,0.000055849,0.000065127,0.000055998,0.000056541,0.000055918,0.000055983,0.000056351,0.000057704,0.000059458,0.000061382,0.000063682,0.000059858,0.000064304,0.000088452,0.000093440},
{0.000094635,0.000089193,0.000064480,0.000059863,0.000063777,0.000061031,0.000059089,0.000058422,0.000056111,0.000055274,0.000058801,0.000056008,0.000055804,0.000064463,0.000055746,0.000056346,0.000058405,0.000059016,0.000060737,0.000063118,0.000060503,0.000063629,0.000088914,0.000094458},
{0.000092984,0.000087367,0.000064129,0.000060358,0.000063444,0.000061010,0.000058796,0.000057796,0.000055837,0.000055604,0.000056122,0.000055881,0.000056466,0.000064221,0.000055378,0.000055554,0.000058292,0.000059374,0.000061235,0.000063286,0.000060584,0.000064208,0.000089445,0.000092198},
{0.000093410,0.000090165,0.000064369,0.000060581,0.000064754,0.000060840,0.000059079,0.000057806,0.000056629,0.000055231,0.000055626,0.000055611,0.000056277,0.000056054,0.000055696,0.000055959,0.000057534,0.000059375,0.000060875,0.000064051,0.000060600,0.000065185,0.000090197,0.000092305},
{0.000092951,0.000089684,0.000065060,0.000060192,0.000063226,0.000060911,0.000059121,0.000058183,0.000056123,0.000055300,0.000055318,0.000055593,0.000056151,0.000055571,0.000055849,0.000056239,0.000058445,0.000059039,0.000061220,0.000063110,0.000060861,0.000064883,0.000088872,0.000093126},
{0.000093221,0.000090580,0.000063956,0.000060185,0.000064210,0.000061402,0.000059086,0.000058511,0.000056197,0.000055215,0.000055952,0.000056225,0.000056199,0.000056145,0.000055393,0.000056357,0.000058458,0.000059947,0.000060960,0.000063178,0.000060418,0.000064427,0.000089757,0.000093307}};
const double rochcor2016::mcor_maer[16][24]={{0.000092771,0.000088681,0.000064113,0.000060875,0.000063784,0.000060757,0.000058737,0.000058439,0.000056068,0.000055746,0.000056529,0.000056325,0.000055354,0.000055880,0.000055516,0.000056643,0.000058242,0.000058987,0.000061579,0.000063931,0.000060212,0.000064048,0.000088597,0.000093395},
{0.000093563,0.000088591,0.000064854,0.000060252,0.000063041,0.000062352,0.000059192,0.000057830,0.000056494,0.000055672,0.000056436,0.000055954,0.000055699,0.000055803,0.000056584,0.000055966,0.000058072,0.000058751,0.000061248,0.000063644,0.000060568,0.000064587,0.000088141,0.000092461},
{0.000093594,0.000088036,0.000065099,0.000060793,0.000063858,0.000061370,0.000059617,0.000058115,0.000056940,0.000055523,0.000056469,0.000056281,0.000056254,0.000056839,0.000056135,0.000056881,0.000058625,0.000060199,0.000061115,0.000063776,0.000059799,0.000064637,0.000087995,0.000093325},
{0.000094472,0.000089567,0.000064256,0.000059783,0.000064088,0.000061430,0.000060486,0.000058749,0.000056632,0.000056021,0.000057022,0.000056418,0.000055873,0.000056921,0.000055982,0.000056197,0.000058489,0.000059275,0.000061465,0.000064259,0.000061088,0.000064946,0.000087700,0.000093951},
{0.000094096,0.000088753,0.000064382,0.000060243,0.000063425,0.000061267,0.000059641,0.000057986,0.000056863,0.000056210,0.000057467,0.000056430,0.000056141,0.000056788,0.000056093,0.000057394,0.000059105,0.000059621,0.000061768,0.000064246,0.000060079,0.000064821,0.000087804,0.000093154},
{0.000094242,0.000087793,0.000065278,0.000060948,0.000063534,0.000061155,0.000059168,0.000057102,0.000055571,0.000055832,0.000055795,0.000055274,0.000055794,0.000056329,0.000055240,0.000055893,0.000057847,0.000058561,0.000061161,0.000063502,0.000059630,0.000064702,0.000087976,0.000093466},
{0.000093348,0.000088973,0.000064695,0.000060570,0.000063601,0.000060769,0.000058725,0.000058291,0.000055756,0.000055528,0.000056417,0.000055487,0.000056320,0.000055428,0.000055252,0.000056598,0.000057784,0.000059051,0.000061332,0.000062863,0.000060086,0.000065672,0.000088446,0.000093928},
{0.000093845,0.000089177,0.000065064,0.000060850,0.000063316,0.000060706,0.000059984,0.000058855,0.000056718,0.000055658,0.000056853,0.000055549,0.000055543,0.000056404,0.000055099,0.000056686,0.000058326,0.000059746,0.000061121,0.000063634,0.000060710,0.000064001,0.000088762,0.000093872},
{0.000092051,0.000089961,0.000064671,0.000060256,0.000063702,0.000060022,0.000058830,0.000058471,0.000056187,0.000055920,0.000056371,0.000056151,0.000055486,0.000056371,0.000055819,0.000056061,0.000058455,0.000059053,0.000060820,0.000063608,0.000060404,0.000064592,0.000088213,0.000092383},
{0.000094503,0.000088789,0.000064938,0.000060152,0.000063596,0.000060065,0.000058868,0.000057574,0.000056526,0.000055224,0.000056850,0.000055708,0.000055812,0.000055300,0.000055363,0.000056369,0.000057674,0.000058786,0.000060327,0.000064925,0.000059715,0.000064487,0.000088023,0.000092915},
{0.000091884,0.000087829,0.000064524,0.000060502,0.000063951,0.000060595,0.000059026,0.000058321,0.000055742,0.000055849,0.000065127,0.000055998,0.000056541,0.000055918,0.000055983,0.000056351,0.000057704,0.000059458,0.000061382,0.000063682,0.000059858,0.000064304,0.000088452,0.000093440},
{0.000094635,0.000089193,0.000064480,0.000059863,0.000063777,0.000061031,0.000059089,0.000058422,0.000056111,0.000055274,0.000058801,0.000056008,0.000055804,0.000064463,0.000055746,0.000056346,0.000058405,0.000059016,0.000060737,0.000063118,0.000060503,0.000063629,0.000088914,0.000094458},
{0.000092984,0.000087367,0.000064129,0.000060358,0.000063444,0.000061010,0.000058796,0.000057796,0.000055837,0.000055604,0.000056122,0.000055881,0.000056466,0.000064221,0.000055378,0.000055554,0.000058292,0.000059374,0.000061235,0.000063286,0.000060584,0.000064208,0.000089445,0.000092198},
{0.000093410,0.000090165,0.000064369,0.000060581,0.000064754,0.000060840,0.000059079,0.000057806,0.000056629,0.000055231,0.000055626,0.000055611,0.000056277,0.000056054,0.000055696,0.000055959,0.000057534,0.000059375,0.000060875,0.000064051,0.000060600,0.000065185,0.000090197,0.000092305},
{0.000092951,0.000089684,0.000065060,0.000060192,0.000063226,0.000060911,0.000059121,0.000058183,0.000056123,0.000055300,0.000055318,0.000055593,0.000056151,0.000055571,0.000055849,0.000056239,0.000058445,0.000059039,0.000061220,0.000063110,0.000060861,0.000064883,0.000088872,0.000093126},
{0.000093221,0.000090580,0.000063956,0.000060185,0.000064210,0.000061402,0.000059086,0.000058511,0.000056197,0.000055215,0.000055952,0.000056225,0.000056199,0.000056145,0.000055393,0.000056357,0.000058458,0.000059947,0.000060960,0.000063178,0.000060418,0.000064427,0.000089757,0.000093307}};

//==========================================================================================================================


const double rochcor2016::dd[12]={0.00164135,0.00428143,0.00878218,0.00884017,0.0150786,0.0195104,0.0179773,0.0364716,0.0220819,0.0329138,0.0297842,0.0092185};
const double rochcor2016::md[12]={0.000141451,0.00295811,0.00151669,0.000608238,0.00354278,0.00655419,0.00473961,0.00488091,0.00720306,0.0118497,0.0232649,0.032047};
const double rochcor2016::dder[12]={0.00153697,0.00130005,0.00179734,0.00216179,0.00262681,0.00343007,0.00431843,0.0047659,0.00559818,0.00747678,0.0133283,0.0164953};
const double rochcor2016::mder[12]={0.000905685,0.0010009,0.00135474,0.00163635,0.00208254,0.00294481,0.00337202,0.00327339,0.00366122,0.00462714,0.00746907,0.0117806};


const double rochcor2016::dscl[24]={0.999501,0.998926,0.999252,0.999313,0.99962,0.999825,1.00005,1.00016,1.00023,1.00036,1.00036,1.00034,1.00011,1.00046,1.00029,1.00041,1.00022,1.00009,0.999884,0.99984,0.999462,0.999388,0.998951,0.999313};
const double rochcor2016::mscl[24]={0.999929,1.00002,1.00004,0.999912,1.00011,0.999915,0.999939,1.00006,0.999958,1.00001,0.999931,1.00021,1.00001,1.00007,1.00013,1.00019,1.00017,0.999997,0.999901,0.999962,0.999783,1.00008,0.999962,1.00002};

RocRes muresol1;

//===============================================================================================

rochcor2016::~rochcor2016(){
}

rochcor2016::rochcor2016(){

  muresol1.init("./RoccoR_13tev.txt");
  muresol1.dumpParams();
  
  eran.SetSeed(123456);
  sran.SetSeed(1234);
  
  gscler_mc_dev=0;
  gscler_da_dev=0;

  for(int i=0; i<16; ++i){
      for(int j=0; j<24; ++j){
          mptsys_mc_dm[i][j]=0;
          mptsys_mc_da[i][j]=0;
          mptsys_da_dm[i][j]=0;
          mptsys_da_da[i][j]=0;
      }
  }

}

rochcor2016::rochcor2016(int seed){

  muresol1.init("./RoccoR_13tev.txt");
  muresol1.dumpParams();

  eran.SetSeed(123456);
  sran.SetSeed(seed);

  gscler_mc_dev=sran.Gaus(0.0, 1.0);
  gscler_da_dev=sran.Gaus(0.0, 1.0);

  for(int i=0; i<16; ++i){
      for(int j=0; j<24; ++j){
          mptsys_mc_dm[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_mc_da[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_da_dm[i][j]=sran.Gaus(0.0, 1.0);
          mptsys_da_da[i][j]=sran.Gaus(0.0, 1.0);
      }
  }
}

void rochcor2016::momcor_mc( TLorentzVector& mu, float charge, int ntrk, float& qter){
  
  //sysdev == num : deviation = num
  double mupt_bfcor = mu.Pt();
  double mupt = mu.Pt();
  double muphi = mu.Phi();
  double mueta = mu.Eta(); // same with mu.Eta() in Root

  double px = mu.Px();
  double py = mu.Py();
  double pz = mu.Pz();
  double e = mu.E();

  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);
  int mu_aetabin = aetabin(mueta);
  
  if(mu_phibin>=0 && mu_etabin>=0){
    
    double Mf = (mcor_bf[mu_phibin][mu_etabin] + mptsys_mc_dm[mu_phibin][mu_etabin]*mcor_bfer[mu_phibin][mu_etabin])/(mpavg[mu_phibin][mu_etabin]+mmavg[mu_phibin][mu_etabin]);
    double Af = ((mcor_ma[mu_phibin][mu_etabin]+mptsys_mc_da[mu_phibin][mu_etabin]*mcor_maer[mu_phibin][mu_etabin]) - Mf*(mpavg[mu_phibin][mu_etabin]-mmavg[mu_phibin][mu_etabin]));     
    
    double cor = 1.0/(1.0 + 2.0*Mf + charge*Af*mupt);
    
    //for the momentum tuning - eta,phi,Q correction
    mupt *= cor;
    
    double gscl = (mgscl);
    double gscler = mgscl_stat;    

    double u = eran.Rndm();
    double w = eran.Rndm();
    double tune = muresol1.kExtraDet(mupt,mueta,ntrk,u,w);
    //double tune = 1.0;

    mupt *= (gscl + gscler_mc_dev*gscler)*(tune*mscl[mu_etabin]);    
    
    //dE/dx correction for low pt is not available in rereco version yet
    double pt_tune = (mupt-md[mu_aetabin])*45.0/(45.0-md[mu_aetabin]);
    mupt = pt_tune;
    
    double momscl = mupt_bfcor/mupt;
    qter *= sqrt(momscl*momscl + (1.0-tune)*(1.0-tune));
    
  }
  
  mu.SetPtEtaPhiM(mupt,mueta,muphi,mu_mass);
}


void rochcor2016::momcor_data( TLorentzVector& mu, float charge, int runopt, float& qter){
  
  double mupt_bfcor = mu.Pt();
  double mupt = mu.Pt();
  
  double muphi = mu.Phi();
  double mueta = mu.Eta(); // same with mu.Eta() in Root
  
  double px = mu.Px();
  double py = mu.Py();
  double pz = mu.Pz();
  double e = mu.E();
  
  int mu_phibin = phibin(muphi);
  int mu_etabin = etabin(mueta);
  int mu_aetabin = aetabin(mueta);

  if(mu_phibin>=0 && mu_etabin>=0){
    
    double Mf = (dcor_bf[mu_phibin][mu_etabin]+mptsys_da_dm[mu_phibin][mu_etabin]*dcor_bfer[mu_phibin][mu_etabin])/(dpavg[mu_phibin][mu_etabin]+dmavg[mu_phibin][mu_etabin]);
    double Af = ((dcor_ma[mu_phibin][mu_etabin]+mptsys_da_da[mu_phibin][mu_etabin]*dcor_maer[mu_phibin][mu_etabin]) - Mf*(dpavg[mu_phibin][mu_etabin]-dmavg[mu_phibin][mu_etabin]));     
    
    double cor = 1.0/(1.0 + 2.0*Mf + charge*Af*mupt);
    
    mupt *= cor;  
    
    //after Z pt correction
    double gscl = (dgscl);
    double gscler = dgscl_stat;

    mupt *= (gscl + gscler_da_dev*gscler)*dscl[mu_etabin];
    
    //dE/dx correction for low pt is not available in rereco version yet
    double pt_tune = (mupt-dd[mu_aetabin])*45.0/(45.0-dd[mu_aetabin]);
    mupt = pt_tune; 
    
    double momscl = mupt_bfcor/mupt;
    qter *= momscl;
    
  }
  
  mu.SetPtEtaPhiM(mupt,mueta,muphi,mu_mass);
  
}

Int_t rochcor2016::phibin(double phi){
  
  int nphibin = -1;
  
  for(int i=0; i<16; i++){
    if(-pi+(2.0*pi/16.0)*i <= phi && -pi+(2.0*pi/16.0)*(i+1) > phi){
      nphibin = i;
      break;
    }
  }
  
  return nphibin;
}

Int_t rochcor2016::etabin(double eta){
  
  int nbin = -1;
  
  for(int i=0; i<24; i++){
    if(netabin[i] <= eta && netabin[i+1] > eta){
      nbin = i;
      break;
    }
  }
  
  return nbin;
}



Int_t rochcor2016::aetabin(double eta){
  
  int nbin = -1;
  
  for(int i=0; i<12; i++){
    if(anetabin[i] <= fabs(eta) && anetabin[i+1] > fabs(eta)){
      nbin = i;
      break;
    }
  }
  
  return nbin;
}

